[General]
SyntaxVersion=2
BeginHotkey=112
BeginHotkeyMod=0
PauseHotkey=0
PauseHotkeyMod=0
StopHotkey=113
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=023a87c4-16d9-4c10-83a1-6fab8e3f550b
Description=卡级后台脚本
Enable=1
AutoRun=0
[Repeat]
Type=0
Number=1
[SetupUI]
Type=1
QUI=Form1
[Relative]
SetupOCXFile=
[Comment]
准备工作：
- 打开糖果浏览器，登陆三个号，两个小号只能加大号一个好友。登陆游戏后把一些提示窗口（如拜师提示等）关闭即可；
- 确保糖果浏览器加速按钮设置为20X；
- 屏幕分辨率的缩放比例设置为100%；

操作步骤：
1、收集窗口：点击对应按钮，再点击对应账号的游戏窗口，分别获取三个号的游戏窗口，用来进行后台操作；（要点选游戏界面，而不是浏览器）
2、点击开始脚本（如果中途有任何错误，需要将三个号都退出至最外层的游戏界面，再重新开始）

如果卡级流程没正常运行？
1、多试几次；2、可以下载源码，导入按键精灵进行调试修改；3、在贴吧或视频评论，我看能否修复；

[Attachment]
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


[UIPackage]
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


[Script]

// ――――――――
// 开关 Clumsy
// ――――――――
DimEnv ClumsyEx 
DimEnv ClumsyBtnEx

// 初始化开关按钮
Function initBtnEx()
	HwndArray = Plugin.WndEx7_70.EnumWindowA(ClumsyEx,"Start","Button",0)
	n = UBound(HwndArray)
	If n=-1 Then
    	TracePrint "clumsy 开始按钮没找到"
	Else
    	str = CStr(HwndArray(0))
    	i = 1
    	For n
        	str = str & "," & CStr(HwndArray(i))
        	i = i + 1
    	Next
    	ClumsyBtnEx = str
	End If
End Function

// 设置filter规则
Function setFilterInput()
	Dim HwndEx
	HwndEx = Plugin.Window.FindEx(ClumsyEx, 0, "Button", "Filtering")
	HwndEx = Plugin.Window.FindEx(HwndEx, 0, "Edit", 0)
	Call Plugin.Window.Active(HwndEx)
	Call Plugin.WndEx7_70.SetWindowText(HwndEx,"outbound",1)
End Function

// 设置筛选函数
Function setFunction()
	FunctionEx = Plugin.Window.FindEx(ClumsyEx, 0, "Button", "Functions")
	
	// 勾选drop
	HwndEx = Plugin.Window.FindEx(FunctionEx, 0, "Button", "Drop")
	Call Plugin.Window.Active(HwndEx)
	Call Plugin.Bkgnd.LeftClick(HwndEx, 2, 2)
	Delay 200
	
	// 去勾选drop的inbound
	HwndArray = Plugin.WndEx7_70.EnumWindowA(FunctionEx,"Inbound","Button",0)
	Call Plugin.Window.Active(HwndArray(1))
	Call Plugin.Bkgnd.LeftClick(HwndArray(1), 2, 2)
	
	// 设置drop的chance
	HwndArray = Plugin.WndEx7_70.EnumWindowA(FunctionEx,0,"Edit",0)
	Call Plugin.Window.Active(HwndArray(1))
	Call Plugin.WndEx7_70.SetWindowText(HwndArray(1), "99.9", 1)
End Function

Function initClumsyEx()
	// 运行clumsy
	Path = Plugin.Sys.GetDir(0)
	RunApp Path&"\clumsy.exe"

	Delay 800

	ClumsyEx = Plugin.Window.Find(0, "clumsy 0.2")
	Call Plugin.Window.Active(ClumsyEx)
	Call initBtnEx()
	Call setFilterInput()
	Call setFunction()
End Function

// 开启/关闭clumsy
Function toggleClumsy()
	TracePrint "clusmy开始" & ClumsyBtnEx
	Call Plugin.Window.Active(ClumsyEx)
	Call Plugin.Window.Active(ClumsyBtnEx)
	Delay 300
	Call Plugin.Bkgnd.LeftClick(ClumsyBtnEx, 10, 10)
	
	Delay 5000
	
	Call Plugin.Window.Active(ClumsyEx)
	Call Plugin.Window.Active(ClumsyBtnEx)
	Delay 300
	Call Plugin.Bkgnd.LeftClick(ClumsyBtnEx, 10, 10)
End Function


// ――――――――
// 浏览器相关
// ――――――――
DimEnv TangoEx
DimEnv TangoBarEx
Dimenv SpeedBtnX
DimEnv SpeedBtnY

DimEnv Flash1Ex // 小号1窗口句柄
DimEnv Flash2Ex // 小号2窗口句柄
DimEnv Flash3Ex // 大号窗口句柄

DimEnv currentFlashEx
currentFlashEx = Flash1Ex

Function delayClick(ex, x, y)
	Delay 300
	Call Plugin.Bkgnd.LeftClick(ex, x, y)
End Function

Function focusFlash(ex)
	Call Plugin.Window.Active(ex)
	currentFlashEx = ex
End Function

// 聚焦小号
Function goToObj(o)
	If o = 1 Then 
		Call focusFlash(Flash1Ex)
	Else 
		Call focusFlash(Flash2Ex)
	End If
End Function

// 聚焦大号
Function goToMe()
	Call focusFlash(Flash3Ex)
End Function

// 打开好友一栏，邀请大号
Function inviteMe()
	// 点击邀请
	Call delayClick(currentFlashEx, 796, 488)
	Delay 300
	
	// 找到好友一栏
	iCoord = Plugin.Bkgnd.FindPic(currentFlashEx,442, 160, 566, 180, "Attachment:\invite_friend.bmp",  0, 0.9)   
	XY = Split(iCoord, "|")
	x = XY(0)
	y = XY(1)
    If x >= 0 And y >= 0 Then 
    	// 打开好友一栏
    	Call delayClick(currentFlashEx, x + 2, y + 2)
    Else 
    	TracePrint "没找到好友栏"
	End If
	
	// 邀请目标用户
	Call delayClick(currentFlashEx, 574, 200)
	// 关闭邀请窗口
	Call delayClick(currentFlashEx, 620, 140)
End Function

Function acceptInvite()
	Call delayClick(Flash3Ex, 426, 386)
End Function

Function readyOrStartGame(o)
	If o = 1 Then 
		Call focusFlash(Flash1Ex)
	ElseIf o = 2 Then
		Call focusFlash(Flash2Ex)
	Else 
		Delay 1000
		Call focusFlash(Flash3Ex)
	End If
	Call delayClick(currentFlashEx, 936, 494)
End Function

Function toggleSpeedUp()
	Call Plugin.Window.Active(TangoEx)
	Delay 100
	Call Plugin.Window.Active(TangoBarEx)
	Delay 100
	Call Plugin.Window.Active(Flash3Ex)
	Delay 100
	
	Call delayClick(TangoBarEx, SpeedBtnX, SpeedBtnY)
End Function

Function quickOut()
	Delay 100
	x = 984
	y = 14
	
	sX = 436
	sY = 338
	For i = 1 To 500
		Call Plugin.Bkgnd.LeftDown(Flash3Ex, x, y)
  		Delay 10
  		Call Plugin.Bkgnd.LeftUp(Flash3Ex, x, y)
  		Delay 10
		Call Plugin.Bkgnd.KeyDown(Flash3Ex, 13)
  		Delay 10
  		Call Plugin.Bkgnd.KeyUp(Flash3Ex, 13)
	Next
End Function

Function gotoChallenge(ex, x, y)
	// 向大号发起挑战
	Call delayClick(ex, x, y)
	
	// 进入打开房间设置
	XY = findPicUntil(ex, 682, 482, 714, 510, "房间设置.bmp", 700, 500)
	
	Call delayClick(ex, XY(0), XY(1))
	Delay 1000
	// 进入设置密码
	Call delayClick(ex, 478, 168)
	For i = 1 To 6
		Call Plugin.Bkgnd.KeyPress(ex, 68)
	Next
	// 进入保存房间设置
	Call delayClick(ex, 500, 528)
	
	// 大号先拒绝
	Call delayClick(Flash3Ex, 694, 208)
End Function

// 查找图片，运行至找到为止，最多只想30次，30次后返回默认位置
Function findPicUntil(ex, x1, y1, x2, y2, path, defaultX, defaultY)
	Dim x
	Dim y
	loopTime = 1
	Do While x < 1 And y < 1
		loopTime = loopTime + 1
    	XY = Plugin.Bkgnd.FindPic(ex, x1, y1, x2, y2, "Attachment:\"&path, 0, 0.8)
    	TracePrint XY
		iZB = InStr(XY, "|")
		x = CLng(Left(XY, iZB - 1))
		y = CLng(Right(XY, Len(XY) - iZB))
		Delay 300
		
		If loopTime > 30 Then 
			x = defaultX
			y = defaultX
			Exit Do
		End If
	Loop
	findPicUntil = Array(x, y)
End Function

Function initChallengeRoom(ex)
	Call focusFlash(ex)
	Delay 300
	
	// 进入大厅
	Call delayClick(ex, 486, 240)
	Delay 3000
	
	XY = findPicUntil(ex, 780, 544, 830, 580, "社交位置.bmp", 804, 566)
	
	// 点开好友
	Call delayClick(ex, XY(0), XY(1))
	Call Plugin.Bkgnd.LeftDown(ex, XY(0), XY(1))


	// 点击大号挑战
	Call delayClick(ex, 774, 288)
	Delay 2000
	
	// 找到挑战按钮
    XY = Plugin.Bkgnd.FindPic(ex, 302, 0, 988, 588, "Attachment:\challenge.bmp", 0, 0.9)
	iZB = InStr(XY, "|")
	x = CLng(Left(XY, iZB - 1))
	y = CLng(Right(XY, Len(XY) - iZB))
	TracePrint XY
    If x >= 0 And y >= 0 Then 
		Call gotoChallenge(ex, x, y)
    Else 
    	iCoord = Plugin.Bkgnd.FindPic(ex, 302, 0, 988, 588, "Attachment:\challengeDark.bmp",  0, 0.9)   
		XY = Split(iCoord, "|")
		x = XY(0)
		y = XY(1)
		TracePrint iCoord
    	If x >= 0 And y >= 0 Then 
			Call gotoChallenge(ex, x, y)
    	Else 
    		TracePrint "实在找到不吐"&ex
    		// 实在找不到图就用死坐标    		
    		Call focusFlash(ex)
    		Call gotoChallenge(ex, 686, 95)
		End If
	End If
End Function

Function StrokeLevel(o)
	Call goToObj(o)
	Call inviteMe()
	
	Delay 1000
	Call acceptInvite()
	
	
	// 大号准备
	Delay 1000
	Call readyOrStartGame(3)
	
	// 小号开始游戏
	Call goToObj(o)
	Call readyOrStartGame(o)
	Call goToMe()
	
	// 打开加速
	Call toggleSpeedUp()
	
	// 找到退出按钮
	XY = findPicUntil(ex, 966, 0, 1000, 28, "退出按钮.bmp", 804, 566)
	
	// 进入游戏中
	Delay 4000
	Call toggleSpeedUp()
	
	// 关闭加速
	BeginThread toggleClumsy
	Delay 400
	
	// 快速点击退出房间
	Call quickOut()
End Function

Function initTango
	TangoEx = Plugin.Window.Find("Tango3", 0)
	Delay 100
	// 糖果浏览器加速那一栏的句柄
	TangoBarEx = Plugin.Window.FindEx(TangoEx, 0, 0, "BrowserBar")
	
	sRect = Plugin.Window.GetWindowRect(TangoBarEx)   
	//下面这句用于分割字符串,将横坐标和纵坐标分成两个字符串      
	MyArray = Split(sRect, "|")   
	//下面这句将字符串转换成数值   
	W1 = Clng(MyArray(0)) : H1 = Clng(MyArray(1))
	W2 = Clng(MyArray(2)): H2 = Clng(MyArray(3))
	
	XY = Plugin.Bkgnd.FindPic(TangoBarEx, (W2 - W1)/2, 0, W2 - W1, H2 - H1, "Attachment:\加速按钮.bmp", 0, 0.8)
	iZB = InStr(XY, "|")
	
	// 找到加速按钮位置
	SpeedBtnX = CLng(Left(XY, iZB - 1))
	SpeedBtnY = CLng(Right(XY, Len(XY) - iZB))
End Function

Function start()
	// 初始化clumsy相关参数
	Call initClumsyEx
	
	// 初始化浏览器相关参数
	Call initTango
	
	// 小号创建房间
	Call initChallengeRoom(Flash1Ex)
	Delay 100
	Call initChallengeRoom(Flash2Ex)
	Delay 100
	
	While True
		Call StrokeLevel(1)
		Delay 5500
		
		Call StrokeLevel(2)
		Delay 5500
	Wend
	
End Function

Sub Main
	If Flash1Ex > 0 and Flash2Ex > 0 and Flash3Ex > 　0 Then 
		Call start
	Else 
		MessageBox "有窗口未获取到，麻烦再确认下"
	End If
End Sub

// ――――――――
// 界面事件相关
// ――――――――
Sub setHwnd(o)
	Dim hwnd
	key = WaitClick()
	hwnd = Plugin.WndEx7_70.GetMousePointWindow()
	sClass = Plugin.Window.GetClass(hwnd)

	If hwnd <= 0 or StrComp(sClass, "MacromediaFlashPlayerActiveX", 1) <> 0 Then 
		MessageBox "窗口获取失败，请重试"
		Exit Sub
	End If
	
	Call Plugin.Msg.ShowScrTXT(0, 0, 1024, 100, "获取到窗口"&hwnd, "0000FF")
	Delay 500
	Call Plugin.Msg.HideScrTXT() 
	
	text = "已获取"
	textColor = "008000"
	
	If o = 1 Then 
		Flash1Ex = hwnd
		Form1.flash1Text.TextColor = textColor
		Form1.flash1Text.Caption = text
	ElseIf o = 2 Then
		Flash2Ex = hwnd
		Form1.flash2Text.TextColor = textColor
		Form1.flash2Text.Caption = text
	Else 
		Flash3Ex = hwnd
		Form1.flash3Text.TextColor = textColor
		Form1.flash3Text.Caption = text
	End If
End Sub

Event Form1.flash1.Click
	BeginThread setHwnd(1)
End Event
Event Form1.flash2.Click
	BeginThread setHwnd(2)
End Event
Event Form1.flash3.Click
	BeginThread setHwnd(3)
End Event

// 开始卡级
Event Form1.startJob.Click
	If Flash1Ex > 0 and Flash2Ex > 0 and Flash3Ex > 　0 Then 
		BeginThread Main
	Else 
		MessageBox "有窗口未获取到，麻烦再确认下"
	End If
End Event

Event Form1.stopJob.Click
	ExitScript
End Event
 

BeginThread setHwnd(1)